<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>    <!-- <script>
        $(document).ready(function(){
            $("div").click(function(){
            $(this).hide();
            });
        });
    //     function showAns() {
    //   document.getElementById("answerH").style.display = "block";
    //     }

    </script> -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/style.css">
    <title>Jeopardy Practice</title>
</head>
<body>
    <div class="filter_container">
        <form action="/filtered" id="filter_form" method="POST">
            <h5>Filter by:</h5>
            <label for="from_season">From Season</label>
            <select name="from_season" id="from_season">
            {% for season in seasons.keys() %}
                <option>{{season}}</option>
            {% endfor %}
            </select>
            <label for="to_season">To Season</label>
            <select name="to_season" id="to_season">
                {% for season in seasons.keys() %}
                    <option>{{season}}</option>
                {% endfor %}
            </select>
            <!-- <label for="browser">Choose your browser from the list:</label>
            <input list="browsers" name="browser" id="browser">
            <datalist id="browsers">
              <option value="Edge">
              <option value="Firefox">
              <option value="Chrome">
              <option value="Opera">
              <option value="Safari">
            </datalist> -->
             <!-- <label for="browser">Choose your browser from the list:</label>
            <input list="browsers" name="browser" id="browser">
            <datalist id="browsers"> -->
            <label for="Category">Category</label>
            <br />
            <input list="Categories" name="category" id="Category">
            <!-- <select name="Category" id="Category"> -->
                <datalist id="Categories">
                    {% for category in categories %}
                        <!-- <option value={{category[0]}}> -->
                        <option>{{category[0]}}</option>
                    {% endfor %}
                </datalist>
            </select>
            <br />
            <label for="value_from">Value From</label>
                <select name="value_from" id="value_from">
                {% for clue_value in clue_values %}
                    <option>{{clue_value[0]}}</option>
                {% endfor %}
                </select>
                <label for="value_to">Value To</label>
                <select name="value_to" id="value_to">
                {% for clue_value in clue_values %}
                    <option>{{clue_value[0]}}</option>
                {% endfor %}
                </select>
            <br><br>
            <input type="submit" onclick="sendData()" value="filter">
            <button onclick="sendData()">Send Data</button>
          </form>
          <div id="output"></div>
    </div> 
    <div class="container">

        <img src="../static/jeopardy-logo.jpg" alt="Jeopardy" class="logo">

        <!--todo - message-->
        <!-- <input id="answerForm" type="text" />
        <input type="button" onclick = "showAnsButton()" value="Submit"/> -->
        <!-- <form action="/", onsubmit = "showAnsButton()" id="answerForm" method="POST"> -->
            <div class="form-group">
                <h3>Season</h3>
                <div id="seasonDiv">
                {% if filtered_data %}
                    {{ filtered_data }}
                    {{ filtered_data[0][-1] }}
                {% else %} 
                    {{ data }}
                    {{ data[0][-1] }}
                {% endif %}
                </div>
                <h3>Value</h3>
                <div id="valueDiv">
                {% if filtered_data %}
                    {{ filtered_data }}
                    {{ filtered_data[0][2] }}
                {% else %} 
                    {{ data }}
                    {{ data[0][2] }}
                {% endif %}
                </div>
                <h3>Category</h3>
                <div id="categoryDiv">
                {% if filtered_data %}
                    {{ filtered_data }}
                    {{ filtered_data[0][3] }}
                {% else %} 
                    {{ data }}
                    {{ data[0][5] }}
                {% endif %}
                </div>    
                <h3>Question</h3>
                <div id="questionDiv">
                {% if filtered_data %}
                    {{ filtered_data[0][4] }}
                {% else %}
                    {{ data[0][4]}}
                {% endif %}    
                </div>

                <h3>Answer</h3>
                <h5>What is....</h5>
                <form action-="/" method="POST" id="answerForm">
                    <input name="answer" id="givenAnswer"><br><br>
                    <div id="submitDiv">
                        <input type="submit" id="submitAnswerButton" value="Submit">
                    </div>
                    {% if message %}
                    <button id="showAnswer" onclick = "showAns()" type="button">Click to reveal answer</button>
                    <div id="AnswerDiv">
                    {% if filtered_data %}
                        <h5 id="answerH"> {{ filtered_data[0][5].lower().replace("<", "") }} </h5>
                    {% else %}   
                        <h5 id="answerH"> {{ data[0][-1].lower().replace("<", "") }} </h5>
                    {% endif %}    
                    </div>

                        {% if message == "Correct!" %}
                            <p id="correctMessage">{{ message | safe }}</p>
                        {% else %}
                            <p id="incorrectMessage">{{ message | safe }}</p>
                        {% endif %}
                    {% endif %}
                </form>                
                <!-- <p> {{ message }} </p> -->
                <div>
                </div>
            </div>
        <!-- </form> -->
        <!-- {% if message %}
        <p class="message">{{ message | safe }}</p>
        {% endif %} -->

        <div>
            <form action="{{ url_for('index') }}">
                <input type="submit" value="Generate Another Question With No Filters" />
            </form>
            <form action="{{ url_for('index') }}">
                <input type="submit" onclick="sendData()" value="Generate Another Question With Current Filters" />
            </form>
        </div>
    </div>

<script>


</script>
</body>
<script>
    var form = document.getElementById("filter_form")
    // //   var input = document.getElementById("jsvar")
    //   form.addEventListener('submit', function(e){
    //     // input.value = "your_var"
    //     form.submit()
    //   })

//     form.addEventListener('submit', function(event) {
//     event.preventDefault();    // prevent page from refreshing
//     const formData = new FormData(form);  // grab the data inside the form fields
//     fetch('/filtered', {   // assuming the backend is hosted on the same server
//         method: 'POST',
//         body: formData,
//     }).then(function(response) {
//         document.getElementById("showAnswer").style.display = "block";
//         return response.text();
//         // do something with the response if needed.
//         // If you want the table to be built only after the backend handles the request and replies, call buildTable() here.
//     }).catch(function(error) {
//     console.log('error = ' + error)
// })
// });

    function sendData() {
            event.preventDefault();    // prevent page from refreshing

            var form = document.getElementById("filter_form")

            var from_season_value = document.getElementById('from_season').value;
            var to_season_value = document.getElementById("to_season").value;
            var category_value = document.getElementById("Category").value;
            var value_from_value = document.getElementById("value_from").value;
            var value_to_value = document.getElementById("value_to").value;

            $.ajax({
                url: '/process-filter',
                type: 'POST',
                // data: {'from_season': from_season_value},
                datatype: 'json',
                data: {'from_season': from_season_value, 'to_season': to_season_value, 'category': category_value, 'from_value': value_from_value,
                    'to_value': value_to_value},
                success: function(response) {
                    form.style.backgroundColor = "red"
                    document.getElementById('categoryDiv').style.backgroundColor = "red"
                    document.getElementById('categoryDiv').innerHTML = JSON.parse(JSON.stringify(response)).category
                    document.getElementById('questionDiv').innerHTML = JSON.parse(JSON.stringify(response)).question
                    document.getElementById('valueDiv').innerHTML = JSON.parse(JSON.stringify(response)).value
                    document.getElementById('seasonDiv').innerHTML = JSON.parse(JSON.stringify(response)).season
                    document.getElementById('answerH').innerHTML = JSON.parse(JSON.stringify(response)).correctAnswer
                },
                error: function(error) {
                    console.log(error);
                }
            });
        }
    // $('button').click(function() {
    //     location.reload();
    // });
    function reload() {
        location.reload();
    }

    function showAns() {
      document.getElementById("answerH").style.display = "block";
      document.getElementById('answerDiv').style.display = "block";
    }
    function showAnsButton() {
        document.getElementById("showAnswer").style.display = "block";
        return false;
    }

    // var form = document.getElementById("")
    var answerButton = document.getElementById("answerForm");
    var showAnswerButton = document.getElementById("showAnswer");
    var submitAnswerButton = document.getElementById("submitAnswerButton")
    answerButton.addEventListener("click",function(e){ 
        showAnswerButton.style.display = "block"
        // submitAnswerButton.style.display = "none"
        // e.preventDefault();
    });

</script>
</html>